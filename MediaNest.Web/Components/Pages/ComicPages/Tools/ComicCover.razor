
<div class="card overflow-hidden" style="width: 15rem; height: 20rem;">
    <a href="/comic/@Target.Id" class="d-block h-100 position-relative">


        <img src="/Assets/Comics/@Target.FolderName/001.jpg"
             alt="@Target.Title"
             class="w-100 h-100 object-fit-cover"
             onerror="fallbackImage(this)" />


        <div class="card-img-overlay d-flex align-items-end p-0">
            <p class="card-title text-center bg-dark bg-opacity-50 text-white w-100 m-0">
                @Target.Title
            </p>
        </div>
    </a>
</div>

@code {
    [Parameter] public Comic Target { get; set; }

    private string GetCoverPath(string ext) => $"/Assets/Comics/{Target.FolderName}/001.{ext}";
}

<style>
    .card-title {
        font-size: 1rem;            /* 預設字體大小 */
        white-space: nowrap;        /* 不換行 */
        overflow: hidden;           /* 隱藏超出部分 */
        text-overflow: ellipsis;    /* 使用省略號 */
        display: block;             /* 使元素為塊級元素 */
        max-width: 100%;            /* 限制最大寬度 */
    }

    .card-title-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background-color: rgba(0, 0, 0, 0.5); /* 半透明黑色背景 */
        color: white;
        text-align: center;
        padding: 1px;                           /* 上下填充 */
        margin: 0;                              /* 移除外邊距 */
        display: flex;                          /* 使用 Flexbox */
        align-items: center;                    /* 垂直置中 */
        justify-content: center;                /* 水平置中 */
    }
</style>

<script>
    function fallbackImage(img) {
        // 備援清單 (依序嘗試)
        const fallbackList = [
            '001.png',
            '001.webp',
            '001.jpeg'
        ];
        // 目前已經嘗試過幾次
        if (!img.dataset.fallbackIndex) {
            img.dataset.fallbackIndex = 0;
        }
        let idx = parseInt(img.dataset.fallbackIndex, 10);

        if (idx < fallbackList.length) {
            img.src = img.src.replace(/001\.\w+$/, fallbackList[idx]);
            img.dataset.fallbackIndex = idx + 1;
        }
    }
</script>
    